{"version":3,"sources":["kendo.pivot.configurator.js"],"names":["f","define","$","undefined","addKPI","data","found","idx","length","type","splice","caption","defaultHierarchy","name","uniqueName","kpiNode","node","normalizeKPIs","settingTargetFromNode","target","closest","kpiMeasure","measure","hierarchyUniqueName","kpi","buildKPImeasures","value","goal","status","trend","PivotConfigurator","kendo","window","ui","Widget","common","pivotgrid","fetchDiscover","configuratorReducer","PIVOT_CONFIGURATOR_ACTION","ns","HOVEREVENTS","SETTINGSTEMPLATE","template","CONTENTTEMPLATE","TARGETITEMTEMPLATE","ACTIONSTEMPLATE","SETTING_CONTAINER_TEMPLATE","PivotConfiguratorV2","extend","init","element","options","fn","call","this","addClass","_dataSource","_layout","refresh","height","notify","events","orientation","filterable","sortable","messages","title","cancelButtonText","applyButtonText","measures","columns","rows","setDataSource","dataSource","that","_refreshHandler","unbind","_errorHandler","_progressHandler","proxy","_error","_requestStart","PivotDataSourceV2","create","bind","horizontal","panel","append","appendTo","formClass","_fields","cancelText","applyText","_targets","on","_actions","e","preventDefault","index","_applyState","read","_cancelChanges","treeView","find","first","last","_createTarget","connectWith","empty","setting","PivotSettingTargetV2","hint","clone","remove","item","wrapper","id","attr","dataItem","getByUid","checked","container","kendoTreeView","checkboxes","checkChildren","dataTextField","autoBind","check","sender","action","toggleSelection","payload","state","columnAxes","_state","rowAxes","measureAxes","result","items","_checkMembers","trigger","_redraw","_treeViewDataSource","off","_clickHandler","HierarchicalDataSource","schema","model","hasChildren","transport","fetchOpts","catalog","cube","fetchOptions","url","members","concat","isEmptyObject","connection","restrictions","catalogName","cubeName","command","then","newFields","success","get","_getKPIOptions","_loadFieldsCommand","newData","hash","field","dimensionUniqueName","_progress","toggle","progress","destroy","fetch","plugin","measuresLabel","columnsLabel","rowsLabel","fieldsLabel","PivotDataSource","promise","schemaDimensions","done","cubeBuilder","fail","error","schemaKPIs","schemaMeasures","schemaLevels","schemaHierarchies","form","dragAndDrop","dragstart","sourceNode","aggregator","drag","dropTarget","validate","setStatusClass","drop","push","add","icons","PivotSettingTarget","emptyTemplate","columnsContainer","icon","rowsContainer","measuresContainer","fieldMenu","_toggleHover","currentTarget","toggleClass","_resize","border","fields","outerHeight","_outerHeight","is","children","innerHeight","_cube","_catalog","jQuery","amd","a1","a2","a3"],"mappings":"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","file":"kendo.pivot.configurator.min.js","sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function (f, define) {\n    define('kendo.pivot.configurator', ['kendo.dom'], f);\n}(function () {\n    var __meta__ = {\n        id: 'pivot.configurator',\n        name: 'PivotConfigurator',\n        category: 'web',\n        depends: [\n            'dropdownlist',\n            'treeview',\n            'pivot.fieldmenu'\n        ],\n        hidden: true\n    };\n    (function ($, undefined) {\n        var kendo = window.kendo, ui = kendo.ui, Widget = ui.Widget, common = window.kendo.pivotgrid.common, fetchDiscover = common.fetchDiscover, configuratorReducer = common.configuratorReducer, PIVOT_CONFIGURATOR_ACTION = common.PIVOT_CONFIGURATOR_ACTION, ns = '.kendoPivotConfigurator', HOVEREVENTS = 'mouseenter' + ns + ' mouseleave' + ns, SETTINGSTEMPLATE = kendo.template('<div class=\"k-pivotgrid-configurator-header\">' + '<div class=\"k-pivotgrid-configurator-header-text\">#:title#</div>' + '</div>'), CONTENTTEMPLATE = kendo.template('<div class=\"k-pivotgrid-configurator-content\">' + '<form class=\"#:formClass#\">' + '#if (horizontal) {# <div class=\"k-form-field-wrapper\"> #}#' + '<div class=\"k-form-field\">' + '<label class=\"k-label\">Fields</label>' + '</div>' + '<div class=\"k-form-field\">' + '<div class=\"k-fields-list-wrapper\"></div>' + '</div>' + '#if (horizontal) {# </div><div class=\"k-form-field-wrapper\"> #}#' + '<div class=\"k-form-field\">' + '<label class=\"k-label\">Columns</label>' + '</div>' + '<div class=\"k-chip-list k-column-fields\"></div>' + '<div class=\"k-form-field\">' + '<label class=\"k-label\">Rows</label>' + '</div>' + '<div class=\"k-chip-list k-row-fields\"></div>' + '#if (horizontal) {# </div><div class=\"k-form-field-wrapper\"> #}#' + '<div class=\"k-form-field\">' + '<label class=\"k-label\">Values</label>' + '</div>' + '<div class=\"k-chip-list k-column-fields\"></div>' + '#if (horizontal) {# </div> #}#' + '</form>' + '</div>'), TARGETITEMTEMPLATE = '<div class=\"k-chip k-chip-has-icon k-chip-solid\">' + '<span class=\"k-chip-content\">' + '<span class=\"k-chip-label\">#:name#</span>' + '#if (menuenabled) {# <span class=\"k-icon k-i-more-vertical\"></span> #}#' + '</span>' + '<span class=\"k-remove-icon\">' + '<span class=\"k-icon k-i-close-circle\"></span>' + '</span>' + '</div>', ACTIONSTEMPLATE = kendo.template('<div class=\"k-pivotgrid-configurator-actions k-actions k-hstack k-justify-content-end\">' + '<button class=\"k-button\">' + '#:cancelText#' + '</button>' + '<button class=\"k-button k-primary\">' + '#:applyText#' + '</button>' + '</div>'), SETTING_CONTAINER_TEMPLATE = kendo.template('<p class=\"k-reset\"><span class=\"k-icon #=icon#\"></span>${name}</p>' + '<div class=\"k-list-container k-reset\"></div>');\n        function addKPI(data) {\n            var found;\n            var idx = 0;\n            var length = data.length;\n            for (; idx < length; idx++) {\n                if (data[idx].type == 2) {\n                    found = true;\n                    break;\n                }\n            }\n            if (found) {\n                data.splice(idx + 1, 0, {\n                    caption: 'KPIs',\n                    defaultHierarchy: '[KPIs]',\n                    name: 'KPIs',\n                    uniqueName: '[KPIs]'\n                });\n            }\n        }\n        function kpiNode(node) {\n            return {\n                name: node.uniqueName,\n                type: node.type\n            };\n        }\n        function normalizeKPIs(data) {\n            for (var idx = 0, length = data.length; idx < length; idx++) {\n                data[idx].uniqueName = data[idx].name;\n                data[idx].type = 'kpi';\n            }\n            return data;\n        }\n        function settingTargetFromNode(node) {\n            var target = $(node).closest('.k-pivot-setting');\n            if (target.length) {\n                return target.data('kendoPivotSettingTarget');\n            }\n            return null;\n        }\n        var PivotConfiguratorV2 = Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass('k-widget k-pivotgrid-configurator k-pos-relative');\n                this._dataSource();\n                this._layout();\n                this.refresh();\n                if (options.height) {\n                    this.element.height(options.height);\n                }\n                kendo.notify(this);\n            },\n            events: [],\n            options: {\n                name: 'PivotConfiguratorV2',\n                orientation: 'vertical',\n                filterable: false,\n                sortable: false,\n                messages: {\n                    title: 'Settings',\n                    cancelButtonText: 'Cancel',\n                    applyButtonText: 'Apply',\n                    measures: 'Select some fields to begin setup',\n                    columns: 'Select some fields to begin setup',\n                    rows: 'Select some fields to begin setup'\n                }\n            },\n            setDataSource: function (dataSource) {\n                this.options.dataSource = dataSource;\n                this._dataSource();\n                if (this.measures) {\n                    this.measures.setDataSource(dataSource);\n                }\n                if (this.rows) {\n                    this.rows.setDataSource(dataSource);\n                }\n                if (this.columns) {\n                    this.columns.setDataSource(dataSource);\n                }\n                this.refresh();\n            },\n            _dataSource: function () {\n                var that = this;\n                if (that.dataSource && that._refreshHandler) {\n                    that.dataSource.unbind('change', that._refreshHandler).unbind('error', that._errorHandler).unbind('progress', that._progressHandler);\n                } else {\n                    that._errorHandler = $.proxy(that._error, that);\n                    that._refreshHandler = $.proxy(that.refresh, that);\n                    that._progressHandler = $.proxy(that._requestStart, that);\n                }\n                that.dataSource = kendo.data.PivotDataSourceV2.create(that.options.dataSource);\n                that.dataSource.bind('change', that._refreshHandler).bind('error', that._errorHandler).bind('progress', that._progressHandler);\n            },\n            _layout: function () {\n                var that = this;\n                var options = that.options;\n                var messages = options.messages;\n                var horizontal = options.orientation == 'horizontal';\n                var panel = $('<div class=\\'k-pivotgrid-configurator-panel k-pivotgrid-configurator-push\\'></div>');\n                panel.addClass(horizontal ? 'k-pivotgrid-configurator-horizontal' : 'k-pivotgrid-configurator-vertical');\n                that.element.append(panel);\n                that.panel = panel;\n                $(SETTINGSTEMPLATE({ title: this.options.messages.title })).appendTo(that.panel);\n                $(CONTENTTEMPLATE({\n                    formClass: horizontal ? 'k-form k-form-horizontal' : 'k-form',\n                    filterable: options.filterable,\n                    horizontal: horizontal\n                })).appendTo(that.panel);\n                that._fields();\n                $(ACTIONSTEMPLATE({\n                    cancelText: messages.cancelButtonText,\n                    applyText: messages.applyButtonText\n                })).appendTo(that.panel);\n                that._targets();\n                that.element.on('click' + ns, '.k-pivotgrid-configurator-actions > button', $.proxy(that._actions, that));\n            },\n            _actions: function (e) {\n                e.preventDefault();\n                var target = $(e.target);\n                if (target.index()) {\n                    this.columns._applyState();\n                    this.rows._applyState();\n                    this.measures._applyState();\n                    this.dataSource.read();\n                } else {\n                    this.columns._cancelChanges();\n                    this.rows._cancelChanges();\n                    this.measures._cancelChanges();\n                    this.treeView.dataSource.read();\n                }\n            },\n            _targets: function () {\n                var that = this;\n                var columns = that.panel.find('.k-column-fields').first();\n                var rows = that.panel.find('.k-row-fields');\n                var measures = that.panel.find('.k-chip-list').last();\n                var options = this.options;\n                this.columns = this._createTarget(columns, {\n                    filterable: options.filterable,\n                    sortable: options.sortable,\n                    template: TARGETITEMTEMPLATE,\n                    connectWith: rows,\n                    messages: { empty: options.messages.columns }\n                });\n                this.rows = this._createTarget(rows, {\n                    filterable: options.filterable,\n                    sortable: options.sortable,\n                    template: TARGETITEMTEMPLATE,\n                    setting: 'rows',\n                    connectWith: columns,\n                    messages: { empty: this.options.messages.rows }\n                });\n                this.measures = this._createTarget(measures, {\n                    setting: 'measures',\n                    template: TARGETITEMTEMPLATE,\n                    messages: { empty: options.messages.measures }\n                });\n            },\n            _createTarget: function (element, options) {\n                var that = this;\n                return new kendo.ui.PivotSettingTargetV2(element, $.extend({\n                    dataSource: this.dataSource,\n                    hint: function (element) {\n                        return element.clone();\n                    },\n                    remove: function (e) {\n                        var item = that.treeView.wrapper.find('[data-name=\\'' + e.name + '\\']').closest('li');\n                        var id = item.attr(kendo.attr('uid'));\n                        var dataItem = that.treeView.dataSource.getByUid(id);\n                        if (dataItem) {\n                            dataItem.checked = false;\n                            item.find('input').attr('checked', false);\n                        }\n                    },\n                    template: options.template\n                }, options));\n            },\n            _fields: function () {\n                var that = this;\n                var container = that.element.find('.k-fields-list-wrapper');\n                this.treeView = $('<div/>').appendTo(container).kendoTreeView({\n                    checkboxes: {\n                        checkChildren: true,\n                        template: '#if ((item.hasChildren || item.aggregator) && item.uniqueName !== \"[KPIs]\" && item.uniqueName !== \"[Measures]\") {# <input type=\"checkbox\" data-name=\"#:item.uniqueName#\" #= item.checked ? \"checked\" : \"\" # class=\"k-checkbox\" id=\"#:item.uid#\" tabindex=\"-1\"> #}#'\n                    },\n                    dataTextField: 'caption',\n                    autoBind: false,\n                    check: function (e) {\n                        var dataItem = e.sender.dataItem(e.node);\n                        var action = {\n                            type: PIVOT_CONFIGURATOR_ACTION.toggleSelection,\n                            payload: dataItem\n                        };\n                        var state = {\n                            columnAxes: that.columns._state(),\n                            rowAxes: that.rows._state(),\n                            measureAxes: that.measures._state()\n                        };\n                        var result = configuratorReducer(state, action);\n                        if (dataItem.defaultHierarchy && dataItem.items.length) {\n                            that._checkMembers([{ name: dataItem.defaultHierarchy }], dataItem.items);\n                            dataItem.items.trigger('change');\n                        }\n                        if (result.columnAxes) {\n                            that.columns._state(result.columnAxes);\n                            that.columns._redraw();\n                        }\n                        if (result.rowAxes) {\n                            that.rows._state(result.rowAxes);\n                            that.rows._redraw();\n                        }\n                        if (result.measureAxes) {\n                            that.measures._state(result.measureAxes);\n                            that.measures._redraw();\n                        }\n                    },\n                    dataSource: this._treeViewDataSource()\n                }).data('kendoTreeView');\n                this.treeView.wrapper.off('click', this.treeView._clickHandler);\n            },\n            _treeViewDataSource: function () {\n                var that = this;\n                return kendo.data.HierarchicalDataSource.create({\n                    schema: {\n                        model: {\n                            id: 'uniqueName',\n                            hasChildren: function (item) {\n                                return !('hierarchyUniqueName' in item) && !('aggregator' in item);\n                            }\n                        }\n                    },\n                    transport: {\n                        read: function (options) {\n                            var node;\n                            var transport = that.dataSource.transport;\n                            var catalog = transport.catalog();\n                            var cube = transport.cube();\n                            var fetchOptions = { url: transport.options.read };\n                            var columns = that.columns._state();\n                            var rows = that.rows._state();\n                            var measures = that.measures._state();\n                            var members = columns.concat(rows).concat(measures);\n                            if ($.isEmptyObject(options.data)) {\n                                var fetchOpts = {\n                                    connection: {\n                                        catalog: catalog,\n                                        cube: cube\n                                    },\n                                    restrictions: {\n                                        catalogName: catalog,\n                                        cubeName: cube\n                                    },\n                                    command: 'schemaDimensions'\n                                };\n                                fetchDiscover(fetchOptions, fetchOpts).then(function (newFields) {\n                                    that._checkMembers(members, newFields);\n                                    addKPI(newFields);\n                                    options.success(newFields);\n                                });\n                            } else {\n                                node = that.treeView.dataSource.get(options.data.uniqueName);\n                                if (node.uniqueName === '[KPIs]') {\n                                    fetchDiscover(fetchOptions, that._getKPIOptions(catalog, cube)).then(function (newFields) {\n                                        options.success(normalizeKPIs(newFields));\n                                    });\n                                } else if (node.type == 'kpi') {\n                                    options.success(buildKPImeasures(node));\n                                } else {\n                                    fetchDiscover(fetchOptions, that._loadFieldsCommand(node, catalog, cube)).then(function (newFields) {\n                                        that._checkMembers(members, newFields);\n                                        options.success(newFields);\n                                    });\n                                }\n                            }\n                        }\n                    }\n                });\n            },\n            _checkMembers: function (members, newData) {\n                var hash = {};\n                var index = 0;\n                for (index = 0; index < members.length; index++) {\n                    hash[members[index].name] = true;\n                }\n                for (index = 0; index < newData.length; index++) {\n                    if (hash[newData[index].uniqueName]) {\n                        newData[index].checked = true;\n                    }\n                }\n            },\n            _getKPIOptions: function (catalog, cube) {\n                return {\n                    connection: {\n                        catalog: catalog,\n                        cube: cube\n                    },\n                    restrictions: {\n                        catalogName: catalog,\n                        cubeName: cube\n                    },\n                    command: 'schemaKPIs'\n                };\n            },\n            _loadFieldsCommand: function (field, catalog, cube) {\n                var command;\n                var dimensionUniqueName;\n                var hierarchyUniqueName;\n                if (field.type === 2) {\n                    command = 'schemaMeasures';\n                } else if (field.dimensionUniqueName) {\n                    command = 'schemaLevels';\n                    hierarchyUniqueName = field.uniqueName;\n                } else {\n                    command = 'schemaHierarchies';\n                    dimensionUniqueName = field.uniqueName;\n                }\n                var options = {\n                    connection: {\n                        catalog: catalog,\n                        cube: cube\n                    },\n                    restrictions: {\n                        catalogName: catalog,\n                        cubeName: cube,\n                        hierarchyUniqueName: hierarchyUniqueName,\n                        dimensionUniqueName: dimensionUniqueName\n                    },\n                    command: command\n                };\n                return options;\n            },\n            _progress: function (toggle) {\n                kendo.ui.progress(this.element, toggle);\n            },\n            _error: function () {\n                this._progress(false);\n            },\n            _requestStart: function () {\n                this._progress(true);\n            },\n            destroy: function () {\n                Widget.fn.destroy.call(this);\n                this.dataSource.unbind('change', this._refreshHandler);\n                this.element.off(ns);\n                this.rows.destroy();\n                this.columns.destroy();\n                this.measures.destroy();\n                this.treeView.destroy();\n                this.element = null;\n                this._refreshHandler = null;\n            },\n            refresh: function () {\n                if (this.treeView) {\n                    this.treeView.dataSource.fetch();\n                }\n                this._progress(false);\n            }\n        });\n        ui.plugin(PivotConfiguratorV2);\n        var PivotConfigurator = Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass('k-widget k-fieldselector k-alt k-edit-form-container');\n                this._dataSource();\n                this._layout();\n                this.refresh();\n                kendo.notify(this);\n            },\n            events: [],\n            options: {\n                name: 'PivotConfigurator',\n                filterable: false,\n                sortable: false,\n                messages: {\n                    measures: 'Drop Data Fields Here',\n                    columns: 'Drop Column Fields Here',\n                    rows: 'Drop Rows Fields Here',\n                    measuresLabel: 'Measures',\n                    columnsLabel: 'Columns',\n                    rowsLabel: 'Rows',\n                    fieldsLabel: 'Fields'\n                }\n            },\n            _dataSource: function () {\n                var that = this;\n                if (that.dataSource && that._refreshHandler) {\n                    that.dataSource.unbind('change', that._refreshHandler).unbind('error', that._errorHandler).unbind('progress', that._progressHandler);\n                } else {\n                    that._errorHandler = $.proxy(that._error, that);\n                    that._refreshHandler = $.proxy(that.refresh, that);\n                    that._progressHandler = $.proxy(that._requestStart, that);\n                }\n                that.dataSource = kendo.data.PivotDataSource.create(that.options.dataSource);\n                that.dataSource.bind('change', that._refreshHandler).bind('error', that._errorHandler).bind('progress', that._progressHandler);\n            },\n            setDataSource: function (dataSource) {\n                this.options.dataSource = dataSource;\n                this._dataSource();\n                if (this.measures) {\n                    this.measures.setDataSource(dataSource);\n                }\n                if (this.rows) {\n                    this.rows.setDataSource(dataSource);\n                }\n                if (this.columns) {\n                    this.columns.setDataSource(dataSource);\n                }\n                this.refresh();\n            },\n            _treeViewDataSource: function () {\n                var that = this;\n                return kendo.data.HierarchicalDataSource.create({\n                    schema: {\n                        model: {\n                            id: 'uniqueName',\n                            hasChildren: function (item) {\n                                return !('hierarchyUniqueName' in item) && !('aggregator' in item);\n                            }\n                        }\n                    },\n                    transport: {\n                        read: function (options) {\n                            var promise;\n                            var node;\n                            var kpi;\n                            if ($.isEmptyObject(options.data)) {\n                                promise = that.dataSource.schemaDimensions();\n                                promise.done(function (data) {\n                                    if (!that.dataSource.cubeBuilder) {\n                                        addKPI(data);\n                                    }\n                                    options.success(data);\n                                }).fail(options.error);\n                            } else {\n                                node = that.treeView.dataSource.get(options.data.uniqueName);\n                                if (node.uniqueName === '[KPIs]') {\n                                    kpi = true;\n                                    promise = that.dataSource.schemaKPIs();\n                                    promise.done(function (data) {\n                                        options.success(normalizeKPIs(data));\n                                    }).fail(options.error);\n                                } else if (node.type == 'kpi') {\n                                    kpi = true;\n                                    options.success(buildKPImeasures(node));\n                                }\n                                if (!kpi) {\n                                    if (node.type == 2) {\n                                        promise = that.dataSource.schemaMeasures();\n                                    } else if (node.dimensionUniqueName) {\n                                        promise = that.dataSource.schemaLevels(options.data.uniqueName);\n                                    } else {\n                                        promise = that.dataSource.schemaHierarchies(options.data.uniqueName);\n                                    }\n                                    promise.done(options.success).fail(options.error);\n                                }\n                            }\n                        }\n                    }\n                });\n            },\n            _progress: function (toggle) {\n                kendo.ui.progress(this.element, toggle);\n            },\n            _error: function () {\n                this._progress(false);\n            },\n            _requestStart: function () {\n                this._progress(true);\n            },\n            _layout: function () {\n                this.form = $('<div class=\"k-columns k-state-default k-floatwrap\"/>').appendTo(this.element);\n                this._fields();\n                this._targets();\n            },\n            _fields: function () {\n                var container = $('<div class=\"k-state-default\"><p class=\"k-reset\"><span class=\"k-icon k-i-group\"></span>' + this.options.messages.fieldsLabel + '</p></div>').appendTo(this.form);\n                var template = '# if (item.type == 2 || item.uniqueName == \"[KPIs]\") { #' + '<span class=\"k-icon k-i-#= (item.type == 2 ? \"sum\" : \"kpi\") #\"></span>' + '# } else if (item.type && item.type !== \"kpi\") { #' + '<span class=\"k-icon k-i-arrows-dimensions\"></span>' + '# } #' + '#: item.caption || item.name #';\n                this.treeView = $('<div/>').appendTo(container).kendoTreeView({\n                    template: template,\n                    dataTextField: 'caption',\n                    dragAndDrop: true,\n                    autoBind: false,\n                    dataSource: this._treeViewDataSource(),\n                    dragstart: function (e) {\n                        var dataItem = this.dataItem(e.sourceNode);\n                        if (!dataItem.hasChildren && !dataItem.aggregator && !dataItem.measure || dataItem.type == 2 || dataItem.uniqueName === '[KPIs]') {\n                            e.preventDefault();\n                        }\n                    },\n                    drag: function (e) {\n                        var status = 'k-i-cancel';\n                        var setting = settingTargetFromNode(e.dropTarget);\n                        if (setting && setting.validate(this.dataItem(e.sourceNode))) {\n                            status = 'k-i-plus';\n                        }\n                        e.setStatusClass(status);\n                    },\n                    drop: function (e) {\n                        e.preventDefault();\n                        var setting = settingTargetFromNode(e.dropTarget);\n                        var node = this.dataItem(e.sourceNode);\n                        var idx, length, measures;\n                        var name;\n                        if (setting && setting.validate(node)) {\n                            name = node.defaultHierarchy || node.uniqueName;\n                            if (node.type === 'kpi') {\n                                measures = buildKPImeasures(node);\n                                length = measures.length;\n                                name = [];\n                                for (idx = 0; idx < length; idx++) {\n                                    name.push(kpiNode(measures[idx]));\n                                }\n                            } else if (node.kpi) {\n                                name = [kpiNode(node)];\n                            }\n                            setting.add(name);\n                        }\n                    }\n                }).data('kendoTreeView');\n            },\n            _createTarget: function (element, options) {\n                var template = '<li class=\"k-item k-header\" data-' + kendo.ns + 'name=\"${data.name}\">${data.name}';\n                var sortable = options.sortable;\n                var icons = '';\n                if (sortable) {\n                    icons += '#if (data.sortIcon) {#';\n                    icons += '<span class=\"k-icon ${data.sortIcon}-sm\"></span>';\n                    icons += '#}#';\n                }\n                if (options.filterable || sortable) {\n                    icons += '<span class=\"k-icon k-i-more-vertical k-setting-fieldmenu\"></span>';\n                }\n                icons += '<span class=\"k-icon k-i-close k-setting-delete\"></span>';\n                template += '<span class=\"k-field-actions\">' + icons + '</span></li>';\n                return new kendo.ui.PivotSettingTarget(element, $.extend({\n                    dataSource: this.dataSource,\n                    hint: function (element) {\n                        var wrapper = $('<div class=\"k-fieldselector\"><ul class=\"k-list k-reset\"></ul></div>');\n                        wrapper.find('.k-list').append(element.clone());\n                        return wrapper;\n                    },\n                    template: template,\n                    emptyTemplate: '<li class=\"k-item k-empty\">${data}</li>'\n                }, options));\n            },\n            _targets: function () {\n                var container = $('<div class=\"k-state-default\"/>').appendTo(this.form);\n                var columnsContainer = $(SETTING_CONTAINER_TEMPLATE({\n                    name: this.options.messages.columnsLabel,\n                    icon: 'k-i-columns'\n                })).appendTo(container);\n                var columns = $('<ul class=\"k-pivot-configurator-settings k-list k-reset\" />').appendTo(columnsContainer.last());\n                var rowsContainer = $(SETTING_CONTAINER_TEMPLATE({\n                    name: this.options.messages.rowsLabel,\n                    icon: 'k-i-rows'\n                })).appendTo(container);\n                var rows = $('<ul class=\"k-pivot-configurator-settings k-list k-reset\" />').appendTo(rowsContainer.last());\n                var measuresContainer = $(SETTING_CONTAINER_TEMPLATE({\n                    name: this.options.messages.measuresLabel,\n                    icon: 'k-i-sum'\n                })).appendTo(container);\n                var measures = $('<ul class=\"k-pivot-configurator-settings k-list k-reset\" />').appendTo(measuresContainer.last());\n                var options = this.options;\n                this.columns = this._createTarget(columns, {\n                    filterable: options.filterable,\n                    sortable: options.sortable,\n                    connectWith: rows,\n                    messages: {\n                        empty: options.messages.columns,\n                        fieldMenu: options.messages.fieldMenu\n                    }\n                });\n                this.rows = this._createTarget(rows, {\n                    filterable: options.filterable,\n                    sortable: options.sortable,\n                    setting: 'rows',\n                    connectWith: columns,\n                    messages: {\n                        empty: this.options.messages.rows,\n                        fieldMenu: this.options.messages.fieldMenu\n                    }\n                });\n                this.measures = this._createTarget(measures, {\n                    setting: 'measures',\n                    messages: { empty: options.messages.measures }\n                });\n                columns.add(rows).add(measures).on(HOVEREVENTS, '.k-item:not(.k-empty)', this._toggleHover);\n            },\n            _toggleHover: function (e) {\n                $(e.currentTarget).toggleClass('k-state-hover', e.type === 'mouseenter');\n            },\n            _resize: function () {\n                var element = this.element;\n                var height = this.options.height;\n                var border, fields;\n                var outerHeight = kendo._outerHeight;\n                if (!height) {\n                    return;\n                }\n                element.height(height);\n                if (element.is(':visible')) {\n                    fields = element.children('.k-columns').children('div.k-state-default');\n                    height = element.innerHeight();\n                    border = (outerHeight(element) - height) / 2;\n                    height = height - (outerHeight(fields, true) - fields.height()) - border;\n                    fields.height(height);\n                }\n            },\n            refresh: function () {\n                var dataSource = this.dataSource;\n                if (dataSource.cubeBuilder || this._cube !== dataSource.cube() || this._catalog !== dataSource.catalog()) {\n                    this.treeView.dataSource.fetch();\n                }\n                this._catalog = this.dataSource.catalog();\n                this._cube = this.dataSource.cube();\n                this._resize();\n                this._progress(false);\n            },\n            destroy: function () {\n                Widget.fn.destroy.call(this);\n                this.dataSource.unbind('change', this._refreshHandler);\n                this.form.find('.k-list').off(ns);\n                this.rows.destroy();\n                this.columns.destroy();\n                this.measures.destroy();\n                this.treeView.destroy();\n                this.element = null;\n                this._refreshHandler = null;\n            }\n        });\n        function kpiMeasure(name, measure, type) {\n            return {\n                hierarchyUniqueName: name,\n                uniqueName: measure,\n                caption: measure,\n                measure: measure,\n                name: measure,\n                type: type,\n                kpi: true\n            };\n        }\n        function buildKPImeasures(node) {\n            var name = node.name;\n            return [\n                kpiMeasure(name, node.value, 'value'),\n                kpiMeasure(name, node.goal, 'goal'),\n                kpiMeasure(name, node.status, 'status'),\n                kpiMeasure(name, node.trend, 'trend')\n            ];\n        }\n        ui.plugin(PivotConfigurator);\n    }(window.kendo.jQuery));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));"]}